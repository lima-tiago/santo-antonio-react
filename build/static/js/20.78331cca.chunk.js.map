{"version":3,"sources":["containers/hipica/Resultados/index.js","axios.instance.js","util/storage.js"],"names":["Resultados","props","useState","setIsFetching","data","setData","pageItems","setPageItems","cavaleiro","cavalos","anos","currFilter","setCurrFilter","listCavaleiros","listCavalos","listAnos","resultados","map","i","label","integrante","value","id","filter","elem","index","self","indexOf","thing","findIndex","t","place","cavalo","Date","date","getFullYear","useEffect","dataName","getStorage","JSON","parse","axios","get","then","response","console","log","setStorage","stringify","catch","err","finally","changeFilter","key","val","old","oldd","className","class","htmlFor","placeholder","noOptionsMessage","onChange","options","length","resul","animationIn","animationOut","isVisible","descricao","style","color","fontFamily","instance","create","baseURL","now","expiresIn","localStorage","getItem","undefined","name","removeItem","e","removeStorage","expires","Math","abs","schedule","setItem"],"mappings":"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","file":"static/js/20.78331cca.chunk.js","sourcesContent":["import axios from 'axios.instance'\r\nimport React, {useState, useEffect} from 'react';\r\nimport {getStorage, setStorage} from 'util/storage';\r\n\r\nimport Select from 'react-select'\r\nimport {Animated} from \"react-animated-css\";\r\n\r\nimport './styles.scss';\r\n\r\nconst Resultados = (props) => {\r\n    const [isFetching,\r\n        setIsFetching] = useState(true);\r\n    const [data,\r\n        setData] = useState(false);\r\n    const [pageItems,\r\n        setPageItems] = useState([]);\r\n    const [currFilter,\r\n        setCurrFilter] = useState({cavaleiro: false, cavalos: false, anos: false});\r\n\r\n    let listCavaleiros = [];\r\n    let listCavalos = [];\r\n    let listAnos = [];\r\n\r\n    if (data.resultados) {\r\n        listCavaleiros = data\r\n            .resultados\r\n            .map(i => {\r\n                return ({label: i.integrante.label, value: i.integrante.id})\r\n            })\r\n            .filter(function (elem, index, self) {\r\n                return index === self.indexOf(elem);\r\n            })\r\n            .filter((thing, index, self) => index === self.findIndex((t) => (t.place === thing.place && t.value === thing.value)));\r\n\r\n        listCavalos = data\r\n            .resultados\r\n            .map(i => {\r\n                return ({label: i.cavalo.label, value: i.cavalo.id})\r\n            })\r\n            .filter((thing, index, self) => index === self.findIndex((t) => (t.place === thing.place && t.value === thing.value)))\r\n\r\n        listAnos = data\r\n            .resultados\r\n            .map(i => {\r\n                return ({\r\n                    label: new Date(i.date).getFullYear(),\r\n                    value: new Date(i.date).getFullYear()\r\n                })\r\n            })\r\n            .filter((thing, index, self) => index === self.findIndex((t) => (t.place === thing.place && t.value === thing.value)));\r\n    }\r\n\r\n    useEffect(() => {\r\n        const dataName = 'hipica-resultados-data';\r\n        if (getStorage(dataName)) {\r\n            setIsFetching(false);\r\n            setData(JSON.parse(getStorage(dataName)));\r\n        } else {\r\n            axios\r\n                .get('/equipe/resultados')\r\n                .then(response => {\r\n                    console.log(response)\r\n                    setData(response.data);\r\n                    setStorage(dataName, JSON.stringify(response.data));\r\n                })\r\n                .catch(err => console.log(err))\r\n                . finally(() => {\r\n                    setIsFetching(false);\r\n                })\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if(data.resultados){\r\n            const pageItems = \r\n        data\r\n            .resultados\r\n            .filter(i => {\r\n                const teste = (currFilter.cavaleiro\r\n                    ? i.integrante.id == currFilter.cavaleiro.value\r\n                    : true) && (currFilter.cavalos\r\n                    ? i.cavalo.id == currFilter.cavalos.value\r\n                    : true) && (currFilter.anos\r\n                    ? new Date(i.date).getFullYear() == currFilter.anos.value\r\n                    : true)\r\n\r\n                return teste;\r\n            })\r\n\r\n        setPageItems(pageItems)\r\n        }\r\n    }, [data, currFilter])\r\n\r\n    const changeFilter = (key, val) => {\r\n        if (!val.value) {\r\n            setCurrFilter(old => {\r\n                const oldd = {\r\n                    ...old\r\n                };\r\n                oldd[key] = false;\r\n                return oldd\r\n            })\r\n        } else {\r\n            setCurrFilter(old => {\r\n                const oldd = {\r\n                    ...old\r\n                };\r\n                oldd[key] = val;\r\n                return oldd\r\n            })\r\n        }\r\n        console.log(currFilter)\r\n    }\r\n\r\n    return (\r\n        <section className=\"Resultados page-interna mb-2 mb-lg-5\">\r\n            <div className=\"container pt-lg-3 pb-lg-3\">\r\n                <div className=\"markup pb-lg-4\">\r\n                    <h2 class=\"mb-4\">Resultados</h2>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"container justify-content-center pb-3 pb-lg-5\">\r\n                <div className=\"row px-lg-0\">\r\n                    <div className=\"col-lg-5 px-lg-4 d-flex\">\r\n                        <div className=\"filter-group\">\r\n                            <label htmlFor=\"\">Cavaleiro</label>\r\n                            <Select\r\n                                className=\"custom-select\"\r\n                                placeholder={'Todos'}\r\n                                noOptionsMessage={() => 'Sem resultados'}\r\n                                onChange={val => changeFilter('cavaleiro', val)}\r\n                                options={[\r\n                                {\r\n                                    label: 'Todos',\r\n                                    value: false\r\n                                },\r\n                                ...listCavaleiros\r\n                            ]}/>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"col-lg-4 px-lg-4 d-flex pr-lg-0\">\r\n                        <div className=\"filter-group\">\r\n                            <label htmlFor=\"\">Cavalos</label>\r\n                            <Select\r\n                                className=\"custom-select\"\r\n                                placeholder={'Todos'}\r\n                                noOptionsMessage={() => 'Sem resultados'}\r\n                                onChange={val => changeFilter('cavalos', val)}\r\n                                options={[\r\n                                {\r\n                                    label: 'Todos',\r\n                                    value: ''\r\n                                },\r\n                                ...listCavalos\r\n                            ]}/>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"col-lg-3 px-lg-4 d-flex pl-lg-0\">\r\n                        <div className=\"filter-group\">\r\n                            <label htmlFor=\"\">Anos</label>\r\n                            <Select\r\n                                className=\"custom-select\"\r\n                                placeholder={'Todos'}\r\n                                noOptionsMessage={() => 'Sem resultados'}\r\n                                onChange={val => changeFilter('anos', val)}\r\n                                options={[\r\n                                {\r\n                                    label: 'Todos',\r\n                                    value: ''\r\n                                },\r\n                                ...listAnos\r\n                            ]}/>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"container\">\r\n                <div className=\"Resultados__list\">\r\n                    {pageItems.length > 0\r\n                        ? pageItems.map((resul, i) => {\r\n                            return (\r\n                                <Animated animationIn=\"fadeIn\" animationOut=\"fadeOut\" isVisible={true} key={i}>\r\n                                    <article className=\"Resultados__item\">\r\n                                        <div className=\"Resultados__item-nomes\">\r\n                                            <span class=\"cavaleiro\">\r\n                                                {resul.integrante.label}\r\n                                            </span>\r\n                                            <span class=\"cavalo\">\r\n                                                {resul.cavalo.label}\r\n                                            </span>\r\n                                        </div>\r\n                                        <div className=\"Resultados__item-resultado\">\r\n                                            {resul.descricao}\r\n                                        </div>\r\n                                    </article>\r\n                                </Animated>\r\n                            )\r\n                        })\r\n                        : <div className=\"col-12 pt-4 text-center\">\r\n                            <h4\r\n                                style={{\r\n                                color: '#9D8855',\r\n                                fontFamily: 'Lowan'\r\n                            }}>Não encontramos resultados para sua busca.</h4>\r\n                        </div>}\r\n                </div>\r\n            </div>\r\n        </section>\r\n    )\r\n}\r\n\r\nexport default Resultados;","import axios from 'axios';\r\n\r\nconst instance = axios.create({\r\n    baseURL: 'https://agenciawebsorocaba.com.br/equipe_sa/api/v1/'\r\n});\r\n\r\nexport default instance;"," /*  removeStorage: removes a key from localStorage and its sibling expiracy key\r\n    params:\r\n        key <string>     : localStorage key to remove\r\n    returns:\r\n        <boolean> : telling if operation succeeded\r\n */\r\nexport function removeStorage(name) {\r\n    try {\r\n        localStorage.removeItem(name);\r\n        localStorage.removeItem(name + '_expiresIn');\r\n    } catch(e) {\r\n        console.log('removeStorage: Error removing key ['+ name + '] from localStorage: ' + JSON.stringify(e) );\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n/*  getStorage: retrieves a key from localStorage previously set with setStorage().\r\n    params:\r\n        key <string> : localStorage key\r\n    returns:\r\n        <string> : value of localStorage key\r\n        null : in case of expired key or failure\r\n */\r\nexport function getStorage(key) {\r\n\r\n    var now = Date.now();  //epoch time, lets deal only with integer\r\n    // set expiration for storage\r\n    var expiresIn = localStorage.getItem(key+'_expiresIn');\r\n    if (expiresIn===undefined || expiresIn===null) { expiresIn = 0; }\r\n\r\n    if (expiresIn < now) {// Expired\r\n        removeStorage(key);\r\n        return null;\r\n    } else {\r\n        try {\r\n            var value = localStorage.getItem(key);\r\n            return value;\r\n        } catch(e) {\r\n            console.log('getStorage: Error reading key ['+ key + '] from localStorage: ' + JSON.stringify(e) );\r\n            return null;\r\n        }\r\n    }\r\n}\r\n/*  setStorage: writes a key into localStorage setting a expire time\r\n    params:\r\n        key <string>     : localStorage key\r\n        value <string>   : localStorage value\r\n        expires <number> : number of seconds from now to expire the key\r\n    returns:\r\n        <boolean> : telling if operation succeeded\r\n */\r\nexport function setStorage(key, value, expires) {\r\n    if (expires===undefined || expires===null) {\r\n        expires = (1*60*60);  // default: seconds for 1 day\r\n    } else {\r\n        expires = Math.abs(expires); //make sure it's positive\r\n    }\r\n\r\n    var now = Date.now();  //millisecs since epoch time, lets deal only with integer\r\n    var schedule = now + expires*1000; \r\n    try {\r\n        localStorage.setItem(key, value);\r\n        localStorage.setItem(key + '_expiresIn', schedule);\r\n    } catch(e) {\r\n        console.log('setStorage: Error setting key ['+ key + '] in localStorage: ' + JSON.stringify(e) );\r\n        return false;\r\n    }\r\n    return true;\r\n}"],"sourceRoot":""}